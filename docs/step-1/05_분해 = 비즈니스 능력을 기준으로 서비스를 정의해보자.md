# 왜 분해/통합 이 어려울까 ? 
- MSA 에서 분리/분해의 의미는 ?
  - Business Capability 를 가질 수 있는 방향으로 서비스를 정의 하는일 -> 통합이 될 수도

수 많은 복잡한 비즈니스가 있는 시스템에서 각 서비스가 Business Capability 를 최대한 가질 수 있도록 '적절하게' 서비스를 정의 하는 일

각 서비스 별로 하나의 DB 를 가진다는 관점에서, 각 서비스 간 적절한 관계를 통해 Business Capability 확보하는 것이 관건 ! 

어떤 기준에 따라서 ? 어떤 지침에 따라서 ? 분리 / 분해/ 통합 하면 좋을지가 Business Capability 를 가질 수 있을까 ???
- -> 비즈니스 동작 / 하위 도메인 패턴이 그 수단이 되어줄 수 있어요  

> 이론적인 이야기 를 좀 쉽게 알아들을 수 있게 다시 정리하면, 도메인에 대한 이해도가 높아야 찢거나, 통합 할 수 있다는 이야기 이다.
> 그게 왜 어렵냐면, `잘` <- 이라고 하는게 그렇게 추상적이면서 짜증나는 말이거든.
> 
> 쉽게 말해 그거 어떻게 하면 잘 할 수 있어 ? 
> - -> 응 `잘` 하면 돼.

### 그래서 그 잘 이라는게 도대체 어떻게 하면 맛있게 뜯어먹을 수 있을까 ? 

- 그게 바로 Business Capability (비즈니스 역량) 이야 
- 이걸 조끔더 주니어 식 와닿게 이야기 하면
- 각 서비스 별 (MSA) 로 쪼개져 있다고 가정할떄 각각 서비스가 DB 를 가질거잖아
  - 각 서비스간 절절한 관계를 통해 비즈니스 영역을 확보하는게 어떻게 보면 분석하기도 쉽고, 유지보수 하기도 쉽고,
  - 유지보수 하는사람들이 욕 안하게 잘 이해할 수 있게 문서화가 용이하고, 비즈니스 영역을 잘 묶고, 잘 나누는 이런 역량을 확보하는것 이라고 생각해
  - (주먹구구 식으로)

### 어떤 기준 들이 있을까 ?
제로베이스 에서 시작해보자

- "배달 주문" 시스템을 위한 서비스 도출 해보기 - 사용자(액터) 입장 에서의 비즈니스 요청 식별
- "비즈니스 동작" 자체를 각 서비스 로 분리.

"주문 서비스" - 고객 입장
- 특정 음식점의 음식들을 주문할 수 있다.

"주문 관리 서비스" - 음식점 입장
- 접수된 주문에 대해서 승낙/거부 등의 처리를 할 수 있다.

"배달 서비스" - 회사 입장
- 승낙 처리된 주문에 대해서, 적절한 배달원과 주문을 매칭 시킬 수 있다.
---

### 비즈니스 동작을 기준으로 분리할 경우
- 비즈니스 동작이 그  자체만으로 매우 중요하거나, 복잡하고 , 비즈니스 변화가 적을 경우 적절할 수 있어.
  - 비즈니스 동작으로 분리를 한다는 이야기는 `그 동작에 포함 된 것들` 이 꽤 많을것이고, 그것들 끼리 응집성을 가졌을때 비즈니스 캐파를 늘릴수 있는경우라면   
  하나의 서비스에서 `동작` 을 기준으로 분리할 수 있을것이야. ( 한트랜잭션에서 지지고 볶는다고 )

### 비즈니스 동작 만을 기준으로 한다면 ?
- 외부 서비스의 의존도가 낮은 비즈니스는 괜찮을 수 있어. 그러나 외부와 빈번하게 통신이 많은경우 제한적일 수 있어
  - 배달 중개 비즈니스가 생기는 변화를 통해, 배달 중개사와 배달원을 유동적으로 매칭해야 하는 상황이 온다면 ? 
    - -> 배달 서비스 는 단순 매칭이 아닌, 적절한 배달 중개사/배달원 매칭을 효율적으로 해야하는 상황 발생
      ( 이말이 뭐냐면, 배달 중개사 와 배달원 사이에 AI 넣고 효율적 이고 최소시간을 보장하는 비즈니스를 곁들여야 할때임)

"비즈니스 동작 기반" -> 경우에 따라 높은 Business Capability 를 가지기 어려운 상황 발생 가능성

---

### 어떤 기준들이 있을까 ? 
"배달 주문" 시스템을 위한 서비스 도출해보기 - 사용자 (액터) 입장에서의 비즈니스 요청 식별
"비즈니스 동작" 에서 "도메인 모델" 을 중심으로 "비즈니스 도메인" 에 초점을 맞추는 방식
- 비즈니스 동작을 분석하는 것에서부터 시작하는 것은 동일!
- 도메인의 복잡성을 이해하고, 도메인의 문제를 해결하는 것에 집중하여 분리/분해의 기준으로 간주하는 방식

> 즉, MSA 에서의 하위 도매ㅔ인을 이용한 분리/ 분해는 각 서비스의 business Capability 를 높이기 위해 필요에 따라 "(하위) 도메인 (sub-domain) 패턴" 별 분리/분해 하는 것이 목적!
> - 하위 도메인 (Sub-Domain) --> 도메인 주도 설계 (Domain-Driven Design, DDD) 에서 나온 개념 

### 하위 도메인 패턴 은
- 하위 도메인으로 식별
- 기존 의 비즈니스 동작을 쪼갠다 -> 비즈니스 캐파를 살릴 수 있는 방식으로 쪼개는게 하위 도메인이다.

